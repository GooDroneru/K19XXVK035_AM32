set(PROJECT_NAME K1921VK035_SDK)
add_library(${PROJECT_NAME} INTERFACE )

target_include_directories(${PROJECT_NAME}
    INTERFACE
        ${CMAKE_CURRENT_SOURCE_DIR}
        "${CMAKE_CURRENT_SOURCE_DIR}/CMSIS/Core/Include/"
        "${CMAKE_CURRENT_SOURCE_DIR}/Device/NIIET/K1921VK035/Include/"
        "${CMAKE_CURRENT_SOURCE_DIR}/plib/inc/"
)

target_sources(${PROJECT_NAME} 
INTERFACE
    CMSIS/Core/Include/cmsis_armcc.h
    CMSIS/Core/Include/cmsis_armclang.h
    CMSIS/Core/Include/cmsis_cmcpp.h
    CMSIS/Core/Include/cmsis_compiler.h
    CMSIS/Core/Include/cmsis_gcc.h
    CMSIS/Core/Include/cmsis_iccarm.h
    CMSIS/Core/Include/cmsis_version.h
    CMSIS/Core/Include/core_cm4.h
    CMSIS/Core/Include/mpu_armv7.h
    Device/NIIET/K1921VK035/Include/K1921VK035.h
    Device/NIIET/K1921VK035/Include/system_K1921VK035.h
    Device/NIIET/K1921VK035/Source/system_K1921VK035.c
    Device/NIIET/K1921VK035/Source/GCC/startup_K1921VK035.S

    plib/src/plib035_adc.c
    plib/src/plib035_can.c
    plib/src/plib035_dma.c
    plib/src/plib035_ecap.c
    plib/src/plib035_gpio.c
    plib/src/plib035_i2c.c
    plib/src/plib035_mflash.c
    plib/src/plib035_pmu.c
    plib/src/plib035_pwm.c
    plib/src/plib035_qep.c
    plib/src/plib035_rcu.c
    plib/src/plib035_spi.c
    plib/src/plib035_tmr.c
    plib/src/plib035_uart.c
    plib/src/plib035_wdt.c

    plib/inc/plib035.h
    plib/inc/plib035_adc.h
    plib/inc/plib035_assert.h
    plib/inc/plib035_can.h
    plib/inc/plib035_conf.h
    plib/inc/plib035_dma.h
    plib/inc/plib035_ecap.h
    plib/inc/plib035_gpio.h
    plib/inc/plib035_i2c.h
    plib/inc/plib035_mflash.h
    plib/inc/plib035_pmu.h
    plib/inc/plib035_pwm.h
    plib/inc/plib035_qep.h
    plib/inc/plib035_rcu.h
    plib/inc/plib035_spi.h
    plib/inc/plib035_tmr.h
    plib/inc/plib035_uart.h
    plib/inc/plib035_version.h
    plib/inc/plib035_wdt.h
)

function(gcc_generate_bin_file TargetName)
    add_custom_command(
        TARGET ${TargetName}
        POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E echo "Generating flash image ${TargetName}.bin"
        COMMAND ${CMAKE_OBJCOPY} -O binary ${TargetName}${CMAKE_EXECUTABLE_SUFFIX_C} ${TargetName}.bin
        BYPRODUCTS ${TargetName}.bin
    )
endfunction()